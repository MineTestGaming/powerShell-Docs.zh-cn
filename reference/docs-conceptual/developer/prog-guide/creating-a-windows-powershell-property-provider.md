---
title: 创建 Windows PowerShell 属性提供程序 |Microsoft Docs
ms.date: 09/13/2016
helpviewer_keywords:
- property providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], property provider
ms.openlocfilehash: e8ef92629fe036154cdd2f0facbe0cbe8add7533
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/05/2020
ms.locfileid: "87778937"
---
# <a name="creating-a-windows-powershell-property-provider"></a><span data-ttu-id="56605-102">创建 Windows PowerShell 属性提供程序</span><span class="sxs-lookup"><span data-stu-id="56605-102">Creating a Windows PowerShell Property Provider</span></span>

<span data-ttu-id="56605-103">本主题介绍如何创建一个提供程序，该提供程序使用户能够操作数据存储区中的项的属性。</span><span class="sxs-lookup"><span data-stu-id="56605-103">This topic describes how to create a provider that enables the user to manipulate the properties of items in a data store.</span></span> <span data-ttu-id="56605-104">因此，这种类型的提供程序称为 Windows PowerShell 属性提供程序。</span><span class="sxs-lookup"><span data-stu-id="56605-104">As a consequence, this type of provider is referred to as a Windows PowerShell property provider.</span></span> <span data-ttu-id="56605-105">例如，Windows PowerShell 提供的注册表提供程序将注册表项值作为该注册表项的属性进行处理。</span><span class="sxs-lookup"><span data-stu-id="56605-105">For example, the Registry provider provided by Windows PowerShell handles registry key values as properties of the registry key item.</span></span> <span data-ttu-id="56605-106">这种类型的提供程序必须将[Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider)接口添加到 .net 类的实现。</span><span class="sxs-lookup"><span data-stu-id="56605-106">This type of provider must add the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface to the implementation of the .NET class.</span></span>

> [!NOTE]
> <span data-ttu-id="56605-107">Windows PowerShell 提供了一个可用于开发 Windows PowerShell 提供程序的模板文件。</span><span class="sxs-lookup"><span data-stu-id="56605-107">Windows PowerShell provides a template file that you can use to develop a Windows PowerShell provider.</span></span> <span data-ttu-id="56605-108">TemplateProvider.cs 文件位于适用于 Windows Vista 的 Microsoft Windows 软件开发工具包和 .NET Framework 3.0 运行时组件中。</span><span class="sxs-lookup"><span data-stu-id="56605-108">The TemplateProvider.cs file is available on the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="56605-109">有关下载说明，请参阅[如何安装 Windows powershell 和下载 Windows POWERSHELL SDK](/powershell/scripting/developer/installing-the-windows-powershell-sdk)。</span><span class="sxs-lookup"><span data-stu-id="56605-109">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="56605-110">下载的模板在目录中提供 **\<PowerShell Samples>** 。</span><span class="sxs-lookup"><span data-stu-id="56605-110">The downloaded template is available in the **\<PowerShell Samples>** directory.</span></span> <span data-ttu-id="56605-111">应创建此文件的副本，并使用该副本创建新的 Windows PowerShell 提供程序，删除不需要的任何功能。</span><span class="sxs-lookup"><span data-stu-id="56605-111">You should make a copy of this file and use the copy for creating a new Windows PowerShell provider, removing any functionality that you do not need.</span></span> <span data-ttu-id="56605-112">有关其他 Windows PowerShell 提供程序实现的详细信息，请参阅[设计 Windows Powershell 提供程序](./designing-your-windows-powershell-provider.md)。</span><span class="sxs-lookup"><span data-stu-id="56605-112">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

> [!CAUTION]
> <span data-ttu-id="56605-113">您的属性提供程序的方法应使用[Cmdletprovider. Writepropertyobject \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject)方法编写任何对象。</span><span class="sxs-lookup"><span data-stu-id="56605-113">The methods of your property provider should write any objects using the [System.Management.Automation.Provider.Cmdletprovider.Writepropertyobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject) method.</span></span>

## <a name="defining-the-windows-powershell-provider"></a><span data-ttu-id="56605-114">定义 Windows PowerShell 提供程序</span><span class="sxs-lookup"><span data-stu-id="56605-114">Defining the Windows PowerShell provider</span></span>

<span data-ttu-id="56605-115">属性提供程序必须创建一个支持[Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider)接口的 .net 类。</span><span class="sxs-lookup"><span data-stu-id="56605-115">A property provider must create a .NET class that supports the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface.</span></span> <span data-ttu-id="56605-116">下面是 Windows PowerShell 提供的 TemplateProvider.cs 文件中的默认类声明。</span><span class="sxs-lookup"><span data-stu-id="56605-116">Here is the default class declaration from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration](Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration)]  -->

## <a name="defining-base-functionality"></a><span data-ttu-id="56605-117">定义基本功能</span><span class="sxs-lookup"><span data-stu-id="56605-117">Defining Base Functionality</span></span>

<span data-ttu-id="56605-118">可以将[Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider)接口附加到任何提供程序基类，但[Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider)类除外，这种情况下，可能会出现这种情况。</span><span class="sxs-lookup"><span data-stu-id="56605-118">The [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface can be attached to any of the provider base classes, with the exception of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class.</span></span> <span data-ttu-id="56605-119">添加所使用的基类所需的基本功能。</span><span class="sxs-lookup"><span data-stu-id="56605-119">Add the base functionality that is required by the base class you are using.</span></span> <span data-ttu-id="56605-120">有关基类的详细信息，请参阅[设计 Windows PowerShell 提供程序](./designing-your-windows-powershell-provider.md)。</span><span class="sxs-lookup"><span data-stu-id="56605-120">For more information about base classes, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

## <a name="retrieving-properties"></a><span data-ttu-id="56605-121">检索属性</span><span class="sxs-lookup"><span data-stu-id="56605-121">Retrieving Properties</span></span>

<span data-ttu-id="56605-122">若要检索属性，提供程序必须实现[Ipropertycmdletprovider. Getproperty \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)方法，以支持来自 cmdlet 的调用 `Get-ItemProperty` 。</span><span class="sxs-lookup"><span data-stu-id="56605-122">To retrieve properties, the provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method to support calls from the `Get-ItemProperty` cmdlet.</span></span> <span data-ttu-id="56605-123">此方法检索位于指定提供程序-内部路径 (完全限定) 的项的属性。</span><span class="sxs-lookup"><span data-stu-id="56605-123">This method retrieves the properties of the item located at the specified provider-internal path (fully-qualified).</span></span>

<span data-ttu-id="56605-124">`providerSpecificPickList`参数指示要检索的属性。</span><span class="sxs-lookup"><span data-stu-id="56605-124">The `providerSpecificPickList` parameter indicates which properties to retrieve.</span></span> <span data-ttu-id="56605-125">如果此参数为 `null` 或空，则该方法应检索所有属性。</span><span class="sxs-lookup"><span data-stu-id="56605-125">If this parameter is `null` or empty, the method should retrieve all properties.</span></span> <span data-ttu-id="56605-126">此外， [Ipropertycmdletprovider. Getproperty \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)将写入表示检索到的属性的属性包的[对象的](/dotnet/api/System.Management.Automation.PSObject)实例中的一个实例。</span><span class="sxs-lookup"><span data-stu-id="56605-126">In addition, [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) writes an instance of a [System.Management.Automation.PSObject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the retrieved properties.</span></span> <span data-ttu-id="56605-127">方法应不返回任何内容。</span><span class="sxs-lookup"><span data-stu-id="56605-127">The method should return nothing.</span></span>

<span data-ttu-id="56605-128">建议为选取列表中的每个元素的属性名称提供通配符扩展。 [Ipropertycmdletprovider. Getproperty \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)的实现。</span><span class="sxs-lookup"><span data-stu-id="56605-128">It is recommended that the implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) supports the wildcard expansion of property names for each element in the pick list.</span></span> <span data-ttu-id="56605-129">为此，请使用[Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern)类来执行通配符模式匹配。</span><span class="sxs-lookup"><span data-stu-id="56605-129">To do this, use the [System.Management.Automation.Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern) class to perform the wildcard pattern matching.</span></span>

<span data-ttu-id="56605-130">下面是 Windows PowerShell 提供的 TemplateProvider.cs 文件中的[Ipropertycmdletprovider. Getproperty \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)的默认实现。</span><span class="sxs-lookup"><span data-stu-id="56605-130">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty)]  -->

#### <a name="things-to-remember-about-implementing-getproperty"></a><span data-ttu-id="56605-131">有关实现 GetProperty 的注意事项</span><span class="sxs-lookup"><span data-stu-id="56605-131">Things to Remember About Implementing GetProperty</span></span>

<span data-ttu-id="56605-132">以下情况可能适用于你的[Ipropertycmdletprovider. Getproperty \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)实现：</span><span class="sxs-lookup"><span data-stu-id="56605-132">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty):</span></span>

- <span data-ttu-id="56605-133">定义提供程序类时，Windows PowerShell 属性提供程序可能会声明 ExpandWildcards、Filter、Include 或 Exclude 的提供程序功能， [Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)枚举。</span><span class="sxs-lookup"><span data-stu-id="56605-133">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="56605-134">在这些情况下， [Ipropertycmdletprovider. Getproperty \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)方法的实现需要确保传递给方法的路径满足指定的功能的要求。）。</span><span class="sxs-lookup"><span data-stu-id="56605-134">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="56605-135">若要执行此操作，方法应访问相应的属性，例如， [Cmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude)和[Cmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)属性中的相应属性，例如 ""。</span><span class="sxs-lookup"><span data-stu-id="56605-135">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="56605-136">默认情况下，除非[Cmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)属性设置为，否则此方法的重写不应检索用户隐藏的对象的读取 `true` 器。</span><span class="sxs-lookup"><span data-stu-id="56605-136">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="56605-137">如果路径表示从用户和[Cmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)中隐藏的项被设置为，则应将错误写入错误 `false` 。</span><span class="sxs-lookup"><span data-stu-id="56605-137">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-itemproperty-cmdlet"></a><span data-ttu-id="56605-138">将动态参数附加到 Set-itemproperty Cmdlet</span><span class="sxs-lookup"><span data-stu-id="56605-138">Attaching Dynamic Parameters to the Get-ItemProperty Cmdlet</span></span>

<span data-ttu-id="56605-139">`Get-ItemProperty`Cmdlet 可能需要在运行时动态指定的其他参数。</span><span class="sxs-lookup"><span data-stu-id="56605-139">The `Get-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="56605-140">为了提供这些动态参数，Windows PowerShell 属性提供程序必须实现[Ipropertycmdletprovider. Getpropertydynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters)方法。</span><span class="sxs-lookup"><span data-stu-id="56605-140">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="56605-141">`path`参数指示完全限定的提供程序内部路径，而 `providerSpecificPickList` 参数指定在命令行上输入的特定于提供程序的属性。</span><span class="sxs-lookup"><span data-stu-id="56605-141">The `path` parameter indicates a fully-qualified provider-internal path, while the `providerSpecificPickList` parameter specifies the provider-specific properties entered on the command line.</span></span> <span data-ttu-id="56605-142">如果将属性传递给 cmdlet，则此参数可以为 `null` 或空。</span><span class="sxs-lookup"><span data-stu-id="56605-142">This parameter might be `null` or empty if the properties are piped to the cmdlet.</span></span> <span data-ttu-id="56605-143">在这种情况下，此方法将返回一个对象，该对象具有与 cmdlet 类或[Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)对象类似的分析特性的属性和字段。</span><span class="sxs-lookup"><span data-stu-id="56605-143">In this case, this method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="56605-144">Windows PowerShell 运行时使用返回的对象将参数添加到 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="56605-144">The Windows PowerShell runtime uses the returned object to add the parameters to the cmdlet.</span></span>

<span data-ttu-id="56605-145">下面是 Windows PowerShell 提供的 TemplateProvider.cs 文件中的[Ipropertycmdletprovider. Getpropertydynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters)的默认实现。</span><span class="sxs-lookup"><span data-stu-id="56605-145">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters)]  -->

## <a name="setting-properties"></a><span data-ttu-id="56605-146">设置属性</span><span class="sxs-lookup"><span data-stu-id="56605-146">Setting Properties</span></span>

<span data-ttu-id="56605-147">若要设置属性，Windows PowerShell 属性提供程序必须实现[Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)方法，以支持来自 cmdlet 的调用 `Set-ItemProperty` 。</span><span class="sxs-lookup"><span data-stu-id="56605-147">To set properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method to support calls from the `Set-ItemProperty` cmdlet.</span></span> <span data-ttu-id="56605-148">此方法设置指定路径处的项的一个或多个属性，并根据需要覆盖提供的属性。</span><span class="sxs-lookup"><span data-stu-id="56605-148">This method sets one or more properties of the item at the specified path, and overwrites the supplied properties as required.</span></span>
<span data-ttu-id="56605-149">[Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)还会写入一个表示已更新属性的属性包的[system.servicemodel 对象的](/dotnet/api/System.Management.Automation.PSObject)实例，该对象表示更新后的属性的属性包。</span><span class="sxs-lookup"><span data-stu-id="56605-149">[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) also writes an instance of a [System.Management.Automation.PSObject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the updated properties.</span></span>

<span data-ttu-id="56605-150">下面是由 Windows PowerShell 提供的 TemplateProvider.cs 文件中的[Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)的默认实现方式。</span><span class="sxs-lookup"><span data-stu-id="56605-150">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty)]  -->

#### <a name="things-to-remember-about-implementing-set-itemproperty"></a><span data-ttu-id="56605-151">有关实现 Set-itemproperty 的注意事项</span><span class="sxs-lookup"><span data-stu-id="56605-151">Things to Remember About Implementing Set-ItemProperty</span></span>

<span data-ttu-id="56605-152">以下情况可能适用于[Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)的实现：：（）</span><span class="sxs-lookup"><span data-stu-id="56605-152">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty):</span></span>

- <span data-ttu-id="56605-153">定义提供程序类时，Windows PowerShell 属性提供程序可能会声明 ExpandWildcards、Filter、Include 或 Exclude 的提供程序功能， [Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)枚举。</span><span class="sxs-lookup"><span data-stu-id="56605-153">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="56605-154">在这些情况下， [Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)方法的实现必须确保传递给该方法的路径满足指定功能的要求。）。</span><span class="sxs-lookup"><span data-stu-id="56605-154">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="56605-155">若要执行此操作，方法应访问相应的属性，例如， [Cmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude)和[Cmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)属性中的相应属性，例如 ""。</span><span class="sxs-lookup"><span data-stu-id="56605-155">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="56605-156">默认情况下，除非[Cmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)属性设置为，否则此方法的重写不应检索用户隐藏的对象的读取 `true` 器。</span><span class="sxs-lookup"><span data-stu-id="56605-156">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="56605-157">如果路径表示从用户和[Cmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)中隐藏的项被设置为，则应将错误写入错误 `false` 。</span><span class="sxs-lookup"><span data-stu-id="56605-157">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="56605-158">在对数据存储进行任何更改之前，你的[Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)方法的实现应调用 Cmdletprovider，并验证其返回值是否为 " [ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) "。</span><span class="sxs-lookup"><span data-stu-id="56605-158">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="56605-159">此方法用于在对系统状态进行更改时（例如，重命名文件）确认操作的执行。</span><span class="sxs-lookup"><span data-stu-id="56605-159">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span>
  <span data-ttu-id="56605-160">在确定应显示的内容时， [Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)将通过 Windows PowerShell 运行时并处理任何命令行设置或首选项变量，来向用户发送要更改的资源的名称。</span><span class="sxs-lookup"><span data-stu-id="56605-160">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime and handling any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="56605-161">在对[Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)的调用返回后 `true` ，如果可以进行可能有危险性的系统修改，则[Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)方法应调用。 [Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)方法（可能为 & i）.. 方法。</span><span class="sxs-lookup"><span data-stu-id="56605-161">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="56605-162">此方法向用户发送一条确认消息，以允许其他反馈指示该操作应继续。</span><span class="sxs-lookup"><span data-stu-id="56605-162">This method sends a confirmation message to the user to allow additional feedback to indicate that the operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-for-the-set-itemproperty-cmdlet"></a><span data-ttu-id="56605-163">为 Set-itemproperty Cmdlet 附加动态参数</span><span class="sxs-lookup"><span data-stu-id="56605-163">Attaching Dynamic Parameters for the Set-ItemProperty Cmdlet</span></span>

<span data-ttu-id="56605-164">`Set-ItemProperty`Cmdlet 可能需要在运行时动态指定的其他参数。</span><span class="sxs-lookup"><span data-stu-id="56605-164">The `Set-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="56605-165">为了提供这些动态参数，Windows PowerShell 属性提供程序必须实现[Ipropertycmdletprovider. Setpropertydynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters)方法。</span><span class="sxs-lookup"><span data-stu-id="56605-165">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="56605-166">此方法返回一个对象，该对象具有与 cmdlet 类或[Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)对象类似的分析特性的属性和字段。</span><span class="sxs-lookup"><span data-stu-id="56605-166">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="56605-167">`null`如果未添加任何动态参数，则可以返回值。</span><span class="sxs-lookup"><span data-stu-id="56605-167">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="56605-168">下面是 Windows PowerShell 提供的 TemplateProvider.cs 文件中的[Ipropertycmdletprovider. Getpropertydynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters)的默认实现。</span><span class="sxs-lookup"><span data-stu-id="56605-168">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters)]  -->

## <a name="clearing-properties"></a><span data-ttu-id="56605-169">清除属性</span><span class="sxs-lookup"><span data-stu-id="56605-169">Clearing Properties</span></span>

<span data-ttu-id="56605-170">若要清除属性，Windows PowerShell 属性提供程序必须实现[Ipropertycmdletprovider. Clearproperty \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)方法，以支持来自 cmdlet 的调用 `Clear-ItemProperty` 。</span><span class="sxs-lookup"><span data-stu-id="56605-170">To clear properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method to support calls from the `Clear-ItemProperty` cmdlet.</span></span> <span data-ttu-id="56605-171">此方法设置位于指定路径的项的一个或多个属性。</span><span class="sxs-lookup"><span data-stu-id="56605-171">This method sets one or more properties for the item located at the specified path.</span></span>

<span data-ttu-id="56605-172">下面是 Windows PowerShell 提供的 TemplateProvider.cs 文件中的[Ipropertycmdletprovider. Clearproperty \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)的默认实现。</span><span class="sxs-lookup"><span data-stu-id="56605-172">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty](Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty)]  -->

#### <a name="thing-to-remember-about-implementing-clearproperty"></a><span data-ttu-id="56605-173">要记住如何实现 ClearProperty</span><span class="sxs-lookup"><span data-stu-id="56605-173">Thing to Remember About Implementing ClearProperty</span></span>

<span data-ttu-id="56605-174">以下情况可能适用于你的[Ipropertycmdletprovider. Clearproperty \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)实现：</span><span class="sxs-lookup"><span data-stu-id="56605-174">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty):</span></span>

- <span data-ttu-id="56605-175">定义提供程序类时，Windows PowerShell 属性提供程序可能会声明 ExpandWildcards、Filter、Include 或 Exclude 的提供程序功能， [Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)枚举。</span><span class="sxs-lookup"><span data-stu-id="56605-175">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="56605-176">在这些情况下， [Ipropertycmdletprovider. Clearproperty \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)方法的实现需要确保传递给方法的路径满足指定的功能的要求。）。</span><span class="sxs-lookup"><span data-stu-id="56605-176">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="56605-177">若要执行此操作，方法应访问相应的属性，例如， [Cmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude)和[Cmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)属性中的相应属性，例如 ""。</span><span class="sxs-lookup"><span data-stu-id="56605-177">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="56605-178">默认情况下，除非[Cmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)属性设置为，否则此方法的重写不应检索用户隐藏的对象的读取 `true` 器。</span><span class="sxs-lookup"><span data-stu-id="56605-178">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="56605-179">如果路径表示从用户和[Cmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)中隐藏的项被设置为，则应将错误写入错误 `false` 。</span><span class="sxs-lookup"><span data-stu-id="56605-179">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="56605-180">在对数据存储进行任何更改之前，你的[Ipropertycmdletprovider 和 Clearproperty \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)方法的实现应调用[Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) ，并验证其返回值的返回值。</span><span class="sxs-lookup"><span data-stu-id="56605-180">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="56605-181">此方法用于在更改系统状态之前确认操作的执行，例如清除内容。</span><span class="sxs-lookup"><span data-stu-id="56605-181">This method is used to confirm execution of an operation before a change is made to system state, such as clearing content.</span></span>
  <span data-ttu-id="56605-182">[Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)发送要更改为用户的资源的名称，Windows PowerShell 运行时在确定应显示的内容时考虑了任何命令行设置或首选项变量。</span><span class="sxs-lookup"><span data-stu-id="56605-182">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="56605-183">在对[Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)的调用返回后 `true` ，如果可以进行潜在的危险系统修改，则[Ipropertycmdletprovider. Clearproperty \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)方法应调用[. Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)方法（可能为可能为可能存在危险的系统。）。</span><span class="sxs-lookup"><span data-stu-id="56605-183">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="56605-184">此方法会向用户发送一条确认消息，以允许其他反馈指示应该继续进行潜在的危险操作。</span><span class="sxs-lookup"><span data-stu-id="56605-184">This method sends a confirmation message to the user to allow additional feedback to indicate that the potentially dangerous operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-to-the-clear-itemproperty-cmdlet"></a><span data-ttu-id="56605-185">将动态参数附加到 Set-itemproperty Cmdlet</span><span class="sxs-lookup"><span data-stu-id="56605-185">Attaching Dynamic Parameters to the Clear-ItemProperty Cmdlet</span></span>

<span data-ttu-id="56605-186">`Clear-ItemProperty`Cmdlet 可能需要在运行时动态指定的其他参数。</span><span class="sxs-lookup"><span data-stu-id="56605-186">The `Clear-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="56605-187">为了提供这些动态参数，Windows PowerShell 属性提供程序必须实现[Ipropertycmdletprovider. Clearpropertydynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters)方法。</span><span class="sxs-lookup"><span data-stu-id="56605-187">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) method.</span></span> <span data-ttu-id="56605-188">此方法返回一个对象，该对象具有与 cmdlet 类或[Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)对象类似的分析特性的属性和字段。</span><span class="sxs-lookup"><span data-stu-id="56605-188">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="56605-189">`null`如果未添加任何动态参数，则可以返回值。</span><span class="sxs-lookup"><span data-stu-id="56605-189">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="56605-190">下面是 Windows PowerShell 提供的 TemplateProvider.cs 文件中的[Ipropertycmdletprovider. Clearpropertydynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters)的默认实现。</span><span class="sxs-lookup"><span data-stu-id="56605-190">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters)]  -->

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="56605-191">生成 Windows PowerShell 提供程序</span><span class="sxs-lookup"><span data-stu-id="56605-191">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="56605-192">请参阅[如何注册 cmdlet、提供程序和主机应用程序](https://msdn.microsoft.com/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)。</span><span class="sxs-lookup"><span data-stu-id="56605-192">See [How to Register Cmdlets, Providers, and Host Applications](https://msdn.microsoft.com/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="see-also"></a><span data-ttu-id="56605-193">另请参阅</span><span class="sxs-lookup"><span data-stu-id="56605-193">See Also</span></span>

[<span data-ttu-id="56605-194">Windows PowerShell 提供程序</span><span class="sxs-lookup"><span data-stu-id="56605-194">Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="56605-195">设计你的 Windows PowerShell 提供程序</span><span class="sxs-lookup"><span data-stu-id="56605-195">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="56605-196">扩展对象类型和格式</span><span class="sxs-lookup"><span data-stu-id="56605-196">Extending Object Types and Formatting</span></span>](https://msdn.microsoft.com/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="56605-197">如何注册 Cmdlet、提供程序和主机应用程序</span><span class="sxs-lookup"><span data-stu-id="56605-197">How to Register Cmdlets, Providers, and Host Applications</span></span>](https://msdn.microsoft.com/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)
